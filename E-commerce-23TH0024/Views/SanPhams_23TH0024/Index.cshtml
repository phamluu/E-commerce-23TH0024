@* @model IEnumerable<E_commerce_23TH0024.Models.SanPhamViewModels>

@{
    ViewBag.Title = "Sản phẩm";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    var grid = new WebGrid(Model, canPage: true, defaultSort: "MaSP desc", canSort: true, rowsPerPage: 10);
}
<style>
    .d-flex {
        align-items: center;
    }

    .form-search label {
        white-space: nowrap;
        margin-right: 5px;
    }
</style>
<h4 class="title">Sản phẩm</h4>

<div class="mb-3">
    @Html.ActionLink("Thêm mới", "Create", "", new { @class = "btn btn-default btn-add" })
    @Html.ActionLink("ImportExcel", "ImportExcel", "FileTransfer_23TH0024", "", new { @class = "btn btn-default btn-importexcel" })
    @Html.ActionLink("Import tùy chỉnh", "ImportExcel_Custom", "FileTransfer_23TH0024", "", new { @class = "btn btn-default btn-importzip" })
    @Html.ActionLink("ExportExcel", "ExportExcel", "FileTransfer_23TH0024", "", new { @class = "btn btn-default btn-exportexcel" })
    <button class="btn btn-primary dropdown-toggle btn-delete" type="button" id="dropdownMenuButton" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
        Xóa
    </button>
    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        <a class="dropdown-item" href="#">Xóa chọn</a>
        <a class="dropdown-item" href="#">Xóa tùy chỉnh</a>
        <a class="dropdown-item" href="javascript:void(0);" onclick="if(confirm('Bạn có chắc chắn muốn xóa tất cả?')) { window.location.href='@Url.Action("DeleteAll")'; }">Xóa tất cả</a>
    </div>
</div>
<div class="form-search mb-3">
    @using (Html.BeginForm("TimKiemNC", "SanPhams_23TH0024", FormMethod.Get))
    {
        @Html.AntiForgeryToken()
        <div class="row">
            <div class="col-md-4">
                <div class="d-flex">
                    <label><b>Tên sản phẩm</b></label>
                    @Html.TextBox("TenSP", "", new { @class = "form-control" })
                </div>
            </div>
            <div class="col-md-4">
                <div class="d-flex">
                    <label><b>Thuộc loại</b></label>
                    @Html.DropDownList("MaLSP", null, "Tất cả", htmlAttributes: new { @class = "form-control" })
                </div>
            </div>
            <div class="col-md-4">
                <div class="d-flex">
                    <label><b>Đơn giá</b></label><span class="mr-1">Từ </span>
                    @Html.TextBox("DonGiaFrom", "", new { @class = "form-control mr-1", @type = "number" })
                    <span class="mr-1">Đến</span>
                    @Html.TextBox("DonGiaTo", "", new { @class = "form-control", @type = "" })
                </div>
            </div>
            <div class="col-md-3 mt-3">
                <input type="submit" name="submit" value="Tìm kiếm" class="btn btn-default bg-success" />
                <input type="button" name="Nhapmoi" value="Nhập mới" class="btn btn-default bg-secondary" onclick="location.href='@Url.Action("TimKiemNC", "SanPhams_23TH0024")'" />
            </div>
        </div>
    }
</div>
<partial name="_AlertMessages" />
<div id="gridContent">
    @ViewBag.TB
    @grid.GetHtml(
    tableStyle: "table table-borderd table-hover",
    headerStyle: "grid-header",
    footerStyle: "grid-footer",
    fillEmptyRows: false,
    mode: WebGridPagerModes.All,
    alternatingRowStyle: "alternatingRowStyle",
    columns: new[]
    {
         grid.Column("STT",format: item => item.WebGrid.Rows.IndexOf(item) + 1 + Math.Round(Convert.ToDouble(grid.TotalRowCount / grid.PageCount) / grid.RowsPerPage) * grid.RowsPerPage * grid.PageIndex),
        grid.Column("Anh","Hình đại diện", format: @<text><img src="~/Uploads/@item.Anh" style="width:70px;" /></text> ),
grid.Column("TenSP","Tên sản phẩm"),
grid.Column("DonGia","Đơn giá"),
grid.Column("DVT","Đơn vị tính"),
grid.Column("LoaiSanPham.TenLSP","Loại sản phẩm"),
grid.Column("Chức năng", format: @<text>
            <a href="@Url.Action("Edit", new { id = item.MaSP})" class="edit-btn"><abbr title="Cập nhật"><i class="fa fa-edit"></i></abbr></a>
            <a href="@Url.Action("Details",new { id = item.MaSP})" class="detail-btn"><abbr title="Xem chi tiết"><i class="fa fa-eye"></i></abbr></a>
            <a href="@Url.Action("Delete", new { id = item.MaSP})" class="delete-btn"><abbr title="Xóa dữ liệu"><i class="fa fa-trash"></i></abbr> </a>
</text>),
})
</div>

<script>
    document.getElementById("dropdownMenuButton").addEventListener("click", function () {
        var dropdownMenu = this.nextElementSibling;
        if (dropdownMenu.style.display === "none" || dropdownMenu.style.display === "") {
            dropdownMenu.style.display = "block";
        } else {
            dropdownMenu.style.display = "none";
        }
    });
    $(document).ready(function () {
        $('#MaLSP').select2();
    });
</script> *@